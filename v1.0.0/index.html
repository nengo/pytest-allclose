<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pytest-allclose &#8212; pytest-allclose 1.0.0 docs</title>
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,600|Rajdhani:700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
  body .title-bar,
  body .documentation-source h1:after {
    background-color: #a8acaf;
  }
</style>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-GT8XEDLTMJ');
</script>
<!-- End Google tag (gtag.js) -->

<!-- Matomo -->
<script>
 var _paq = window._paq = window._paq || [];
 _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
 _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
 _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.labs.nengo.ai","*.nengo.ai"]]);
 _paq.push(["enableCrossDomainLinking"]);
 _paq.push(["setDoNotTrack", true]);
 _paq.push(['trackPageView']);
 _paq.push(['enableLinkTracking']);
 (function() {
   var u="https://appliedbrainresearch.matomo.cloud/";
   _paq.push(['setTrackerUrl', u+'matomo.php']);
   _paq.push(['setSiteId', '3']);
   var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
   g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
 })();
</script>
<!-- End Matomo Code -->
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>


<script type="text/javascript" src="_static/underscore.js"></script>


<script type="text/javascript" src="_static/doctools.js"></script>


<script type="text/javascript" src="_static/language_data.js"></script>

    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark">

<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai">
      <img
        src="https://www.nengo.ai/design/_images/general-full-light.svg"
        alt="Nengo"
        class="logo"
      />
    </a>
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbar-collapse"
      aria-controls="navbar-collapse"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai">What is Nengo?</a>
        </li>
        <li class="nav-item dropdown active">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-docs"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Documentation</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-docs"
          >

            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo Core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">Nengo GUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">Nengo DL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">Nengo SPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">Nengo Extras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-examples/">Nengo Examples</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">Nengo FPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">Nengo Loihi</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-ocl">Nengo OpenCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">Nengo SpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">Nengo MPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation"
              >All documentation</a
            >
          </div>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-community"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Community</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-community"
          >
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people"
              >People</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school"
              >Summer school</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/contributing"
              >Contributing</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/publications"
              >Publications</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/videos"
              >Videos</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/conduct"
              >Code of conduct</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/caa">CAA</a>
          </div>
        </li>
        <li class="nav-item">
          <a
            class="nav-link btn btn-success btn-sm text-white"
            href="https://www.nengo.ai/download"
            >Download</a
          >
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="#">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/general-small-light.svg"
        alt="pytest-allclose"
      />
    </a>
  </h3>

  <form class="px-5 pb-5 mb-0 mt-3 border-bottom">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">


        <option value="../index.html">latest</option>



        <option selected>v1.0.0</option>


      </select>
    </div>
  </form>

  <div class="p-5 toctree">
    <ul>
<li><a class="reference internal" href="#">pytest-allclose</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#additional-arguments">Additional arguments</a></li>
<li><a class="reference internal" href="#rmse-error-reporting">RMSE error reporting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#allclose-tolerances">allclose_tolerances</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-reference">API reference</a></li>
</ul>
</li>
</ul>

  </div>
<form class="p-5 my-0 border-top" action="search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form></div>


      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source">

  <div class="section" id="pytest-allclose">
<h1>pytest-allclose<a class="headerlink" href="#pytest-allclose" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">pytest-allclose</span></code> provides the <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> Pytest fixture,
extending <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html#numpy.allclose" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.allclose</span></code></a> with test-specific features.</p>
<p>A core feature of the <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> fixture
is that the tolerances for tests can be configured externally.
This allows different repositories to share the same tests,
but use different tolerances.
See the “Configuration” section below for details.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>To use this fixture, install with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pytest-allclose
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> fixture is used just like <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html#numpy.allclose" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.allclose</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">test_close</span><span class="p">(</span><span class="n">allclose</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.001</span>
    <span class="k">assert</span> <span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="additional-arguments">
<h3>Additional arguments<a class="headerlink" href="#additional-arguments" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> fixture has a number of arguments
that are not part of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html#numpy.allclose" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.allclose</span></code></a>.
One such argument is <code class="docutils literal notranslate"><span class="pre">xtol</span></code>,
which allows arrays that have been shifted along their first axis
by a certain number of steps to be considered close.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">test_close</span><span class="p">(</span><span class="n">allclose</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">allclose</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">allclose</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">:],</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">allclose</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">:],</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Refer to the <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> API reference for all additional arguments.</p>
</div>
<div class="section" id="rmse-error-reporting">
<h3>RMSE error reporting<a class="headerlink" href="#rmse-error-reporting" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> fixture stores root-mean-square error values,
which can be reported in the pytest terminal summary.
To do so, put the following in your <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytest_allclose</span> <span class="kn">import</span> <span class="n">report_rmses</span>

<span class="k">def</span> <span class="nf">pytest_terminal_summary</span><span class="p">(</span><span class="n">terminalreporter</span><span class="p">):</span>
    <span class="n">report_rmses</span><span class="p">(</span><span class="n">terminalreporter</span><span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="#pytest_allclose.report_rmses" title="pytest_allclose.report_rmses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">report_rmses</span></code></a> API reference for more information.</p>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="allclose-tolerances">
<h3>allclose_tolerances<a class="headerlink" href="#allclose-tolerances" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">allclose_tolerances</span></code> accepts a list of test name patterns,
followed by values for any of the <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> parameters.
These values will override any values provided within the test function itself,
allowing multiple repositories to use the same test suite,
but with different tolerances.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">allclose_tolerances</span> <span class="o">=</span><span class="s"></span>
<span class="s">    test_file.py:test_function atol=0.3  # set atol for specific test</span>
<span class="s">    test_file.py:test_func* rtol=0.2  # set rtol for tests matching wildcard</span>
<span class="s">    test_file.py:* atol=0.1 rtol=0.3  # set both tols for all tests in file</span>
<span class="s">    test_*tion rtol=0.2  # set rtol for all matching tests in any file</span>
<span class="s">    test_function[True] atol=0.1  # set atol only for one parametrization</span>
</pre></div>
</div>
<p>The only special character recognized in these patterns
is the wildcard character <code class="docutils literal notranslate"><span class="pre">*</span></code>,
which matches any group of zero or more characters.</p>
<p>If the test is parametrized,
then a pattern like <code class="docutils literal notranslate"><span class="pre">test_name[param0-param1]</span></code>
will match specific parameter settings,
and <code class="docutils literal notranslate"><span class="pre">test_name*</span></code> will match all parameter settings.
Note that the latter will match any test that starts with <code class="docutils literal notranslate"><span class="pre">test_name</span></code>.</p>
<p>If a test has multiple <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> calls,
you can use multiple tolerance lines that match the same test
to set different values for the first, second, third, etc. calls.
If there are more <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> calls than tolerance lines,
the last tolerance line will be used for all remaining <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> calls.</p>
<p>Example test file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_close</span><span class="p">(</span><span class="n">allclose</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.001</span>
    <span class="k">assert</span> <span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Example configuration file (<code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>, <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">allclose_tolerances</span> <span class="o">=</span><span class="s"></span>
<span class="s">    test_close atol=0.002  # affects first allclose call</span>
<span class="s">    test_close atol=0.0005  # affects second allclose call</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Different tolerance lines correspond to <em>calls</em> of the
function, not lines of code. If you have a <code class="docutils literal notranslate"><span class="pre">for</span></code>
loop that calls <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> 3 times,
each of these calls corresponds to a new tolerance line.
If you have a fourth <a class="reference internal" href="#pytest_allclose.plugin.allclose" title="pytest_allclose.plugin.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a> call,
you would need three tolerance lines for the three calls
in the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, then a fourth line for the last call.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The patterns for multiple calls of allclose in a function
must be exactly the same.
This means that if you have specific values for one
parametrization and general values for others,
you must put the specific values first
or they will not have any effect.</p>
<p>Good example, specific takes precedence:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">allclose_tolerances</span> <span class="o">=</span><span class="s"></span>
<span class="s">    test_close[True-1] atol=0.002</span>
<span class="s">    test_close[True-1] atol=0.0005</span>
<span class="s">    test_close* atol=0.001</span>
<span class="s">    test_close* atol=0.0001</span>
</pre></div>
</div>
<p>Bad example, general takes precedence:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">allclose_tolerances</span> <span class="o">=</span><span class="s"></span>
<span class="s">    test_close* atol=0.001</span>
<span class="s">    test_close* atol=0.0001</span>
<span class="s">    test_close[True-1] atol=0.002</span>
<span class="s">    test_close[True-1] atol=0.0005</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="api-reference">
<h2>API reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pytest_allclose.plugin.allclose">
<code class="sig-prename descclassname">pytest_allclose.plugin.</code><code class="sig-name descname">allclose</code><span class="sig-paren">(</span><em class="sig-param">request</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytest_allclose/plugin.html#allclose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytest_allclose.plugin.allclose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function checking if two arrays are close, mimicking <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html#numpy.allclose" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.allclose</span></code></a>.</p>
<dl class="function">
<dt>
<code class="sig-prename descclassname">allclose.</code><code class="sig-name descname">_allclose</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">rtol=1e-5</em>, <em class="sig-param">atol=1e-8</em>, <em class="sig-param">xtol=0</em>, <em class="sig-param">equal_nan=False</em>, <em class="sig-param">print_fail=5</em>, <em class="sig-param">record_rmse=True</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a</strong><span class="classifier">np.ndarray</span></dt><dd><p>First array to be compared.</p>
</dd>
<dt><strong>b</strong><span class="classifier">np.ndarray</span></dt><dd><p>Second array to be compared.</p>
</dd>
<dt><strong>rtol</strong><span class="classifier">float, optional</span></dt><dd><p>Relative tolerance between a and b (relative to b).</p>
</dd>
<dt><strong>atol</strong><span class="classifier">float, optional</span></dt><dd><p>Absolute tolerance between a and b.</p>
</dd>
<dt><strong>xtol</strong><span class="classifier">int, optional</span></dt><dd><p>Allow signals to be right or left shifted by up to <code class="docutils literal notranslate"><span class="pre">xtol</span></code>
indices along the first axis</p>
</dd>
<dt><strong>equal_nan</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, nans will be considered equal to nans.</p>
</dd>
<dt><strong>print_fail</strong><span class="classifier">int, optional</span></dt><dd><p>If &gt; 0, print out the first <code class="docutils literal notranslate"><span class="pre">print_fail</span></code> entries failing
the allclose check along the first axis.</p>
</dd>
<dt><strong>record_rmse</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to record the RMSE value for this comparison. Defaults to True.
Set to False whenever <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> should be far apart
(when ensuring two signals are sufficiently different, for example).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>True if the two arrays are considered close according to the tolerances.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pytest_allclose.report_rmses">
<code class="sig-prename descclassname">pytest_allclose.</code><code class="sig-name descname">report_rmses</code><span class="sig-paren">(</span><em class="sig-param">terminalreporter</em>, <em class="sig-param">relative=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytest_allclose/plugin.html#report_rmses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytest_allclose.report_rmses" title="Permalink to this definition">¶</a></dt>
<dd><p>Report RMSEs recorded by the allclose fixture in the Pytest terminal.</p>
<p>This function helps with reporting recorded root mean squared errors
(RMSEs). These RMSEs offer a measure of performance for each test
by quantifying how close their outputs are to the target values.
While this metric has some value on its own, it is most useful as a
relative metric, to evaluate if change offers an improvement to tests,
and if so, how much.</p>
<p>When using RMSEs, it is important to set <code class="docutils literal notranslate"><span class="pre">record_rmse</span></code> to False on any
<code class="docutils literal notranslate"><span class="pre">allclose</span></code> call where closer values correspond to a drop in performance
(e.g. when using <code class="docutils literal notranslate"><span class="pre">allclose</span></code> to ensure values are different).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>terminalreporter</strong><span class="classifier">_pytest.terminal.TerminalReporter</span></dt><dd><p>The terminal reporter object provided by <code class="docutils literal notranslate"><span class="pre">pytest_terminal_summary</span></code>.</p>
</dd>
<dt><strong>relative</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to print relative (default) or absolute RMSEs. Relative RMSEs
are normalized by the mean RMS of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> in <code class="docutils literal notranslate"><span class="pre">allclose</span></code>.
Since different tests often compare against values of different
magnitudes, relative RMSEs provide a better metric across tests by
ensuring all tests contribute proportionally to the average RMSE.
One exception is when comparing to a signal that is all zeros, since
the relative RMSE will always be 2 no matter how close the values are.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>See <a class="reference internal" href="#rmse-error-reporting">RMSE error reporting</a> for an example.</p>
</dd></dl>

</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom">
  <p class="small text-center mb-0">
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/download/">Download</a>
    <a href="https://appliedbrainresearch.com">ABR</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>
